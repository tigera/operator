{
  "apiVersion": "projectcalico.org/v3",
  "kind": "NetworkPolicy",
  "metadata": {
    "name": "allow-tigera.cluster-dns",
    "namespace": "openshift-dns"
  },
  "spec": {
    "tier":"allow-tigera",
    "order":1,
    "ingress":[
      {
        "action":"Allow",
        "source":{
          "selector":"projectcalico.org/namespace in {'tigera-guardian','tigera-compliance','tigera-dex','tigera-elasticsearch','tigera-fluentd','tigera-intrusion-detection','tigera-kibana','tigera-manager','tigera-prometheus','tigera-skraper','tigera-system'}",
          "namespaceSelector":"all()"
        },
        "destination":{}
      },
      {
        "action": "Allow",
        "protocol":"UDP",
        "source": {
          "services": {
            "name": "node-local-dns",
            "namespace": "openshift-dns"
          },
          "ports": [
            53
          ]
        }
      },
      {
        "action": "Allow",
        "protocol": "TCP",
        "source": {
          "services": {
            "name": "node-local-dns",
            "namespace": "openshift-dns"
          },
          "ports": [
            53
          ]
        }
      },
      {
        "action":"Pass",
        "source":{},
        "destination":{}
      }
    ],
    "egress":[
      {
        "action":"Allow",
        "source":{},
        "destination":{}
      }
    ],
    "selector":"dns.operator.openshift.io/daemonset-dns == 'default'",
    "types":[
      "Ingress",
      "Egress"
    ]
  }
}
